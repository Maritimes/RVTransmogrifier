% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stratify.R
\name{widen_length_data}
\alias{widen_length_data}
\title{widen_length_data}
\usage{
widen_length_data(data, value_col, bin_size = 1, level = c("strata", "set"))
}
\arguments{
\item{data}{A data frame containing length frequency data. Must include columns: FLEN (fish length), STRAT (stratum), AREA_KM2 (area), SPEC (species code), and the column specified in value_col. For set-level data, must also include MISSION and SETNO.}

\item{value_col}{The name of the column to aggregate and pivot. Common options include "CLEN_TOTAL", "CLEN_MEAN", "CLEN_SE", "CLEN_STRAT_TOTAL", or "CLEN_SQKM_SE".}

\item{bin_size}{the default is \code{1}. The width of length bins. Length values are binned using the formula: 1 + bin_size * floor(FLEN / bin_size).}

\item{level}{the default is \code{c("strata", "set")}. Specifies the aggregation level. "set" includes MISSION and SETNO in grouping; "strata" aggregates across all sets within each stratum.}
}
\value{
A wide-format data frame with columns for grouping variables (STRAT, AREA_KM2, SPEC, and optionally MISSION/SETNO) and FLEN_* columns (one per length bin). Rows are sorted by STRAT (and MISSION, SETNO for set-level data).
}
\description{
Transform length frequency data from long to wide format, with length bins as columns. This function bins fish length data according to a specified bin size, aggregates a chosen value column within each bin, and creates a wide-format table where each length bin becomes a separate column. Can operate at either set-level (individual tows) or strata-level (aggregated across sets). Missing length bins are filled with zeros to ensure complete coverage across the length range.
}
\note{
The binning formula (1 + bin_size * floor(FLEN / bin_size)) matches the DFO standard used in Oracle queries. For bin_size=3, this creates bins at 4, 7, 10, 13, etc.
}
\examples{
\dontrun{
result5 <- widen_length_data(testData_strat_det$length_set, value_col = "CLEN_TOTAL",  bin_size = 3,level = "set")
result1 <- widen_length_data(testData_strat_det$length_strat, value_col = "CLEN_MEAN", bin_size = 1,level = "strat")
result2 <- widen_length_data(testData_strat_det$length_strat, value_col = "CLEN_SE", bin_size = 1,level = "strat")
result3 <- widen_length_data(testData_strat_det$length_strat, value_col = "CLEN_STRAT_TOTAL", bin_size = 1,level = "strat")
result4 <- widen_length_data(testData_strat_det$length_strat, value_col = "CLEN_SQKM_SE", bin_size = 1,level = "strat")
}
}
\author{
Mike McMahon, \email{Mike.McMahon@dfo-mpo.gc.ca}
}
